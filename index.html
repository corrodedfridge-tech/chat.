<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat.</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        *{margin:0;padding:0;box-sizing:border-box}:root{--bg-primary:#1a1a2e;--bg-secondary:#16213e;--bg-tertiary:#0f0f23;--bg-quaternary:#1f1f3a;--accent:#6c5ce7;--accent-hover:#5b4cdb;--accent-light:rgba(108,92,231,0.2);--text-primary:#fff;--text-secondary:#b2b2c9;--text-muted:#72728f;--online:#2ecc71;--offline:#636e72;--danger:#e74c3c;--success:#2ecc71;--border:rgba(255,255,255,0.08);--message-hover:rgba(255,255,255,0.03)}body{font-family:'Inter',sans-serif;background:var(--bg-primary);color:var(--text-primary);height:100vh;overflow:hidden}::-webkit-scrollbar{width:6px}::-webkit-scrollbar-track{background:transparent}::-webkit-scrollbar-thumb{background:rgba(255,255,255,0.1);border-radius:3px}.auth-container{display:flex;justify-content:center;align-items:center;min-height:100vh;background:linear-gradient(135deg,var(--bg-tertiary),var(--bg-primary),var(--bg-secondary));padding:20px}.auth-box{background:var(--bg-quaternary);border-radius:16px;padding:40px;width:100%;max-width:420px;box-shadow:0 20px 60px rgba(0,0,0,0.4);border:1px solid var(--border)}.auth-logo{text-align:center;margin-bottom:32px}.auth-logo h1{font-size:32px;font-weight:700;background:linear-gradient(135deg,var(--accent),#a29bfe);-webkit-background-clip:text;-webkit-text-fill-color:transparent}.auth-logo p{color:var(--text-secondary);margin-top:8px;font-size:14px}.auth-tabs{display:flex;gap:8px;margin-bottom:24px;background:var(--bg-tertiary);padding:4px;border-radius:10px}.auth-tab{flex:1;padding:12px;border:none;background:transparent;color:var(--text-secondary);font-size:14px;font-weight:500;cursor:pointer;border-radius:8px;transition:all 0.2s}.auth-tab.active{background:var(--accent);color:#fff}.auth-form{display:none}.auth-form.active{display:block}.form-group{margin-bottom:20px}.form-group label{display:block;font-size:12px;font-weight:600;color:var(--text-secondary);margin-bottom:8px;text-transform:uppercase}.form-group input{width:100%;padding:14px 16px;background:var(--bg-tertiary);border:1px solid var(--border);border-radius:10px;color:var(--text-primary);font-size:15px}.form-group input:focus{outline:none;border-color:var(--accent)}.phone-input-group{display:flex;gap:8px}.phone-input-group select{width:100px;padding:14px;background:var(--bg-tertiary);border:1px solid var(--border);border-radius:10px;color:var(--text-primary)}.phone-input-group input{flex:1}.btn{width:100%;padding:14px 24px;border:none;border-radius:10px;font-size:15px;font-weight:600;cursor:pointer;transition:all 0.2s;display:flex;align-items:center;justify-content:center;gap:10px}.btn-primary{background:var(--accent);color:#fff}.btn-primary:hover{background:var(--accent-hover)}.btn-google{background:#fff;color:#333;margin-top:12px}.btn-secondary{background:transparent;color:var(--text-secondary)}.divider{display:flex;align-items:center;margin:24px 0}.divider::before,.divider::after{content:'';flex:1;height:1px;background:var(--border)}.divider span{padding:0 16px;color:var(--text-muted);font-size:13px}.verification-sent{text-align:center;padding:20px}.verification-sent svg{width:64px;height:64px;color:var(--accent);margin-bottom:16px}.verification-input{display:flex;gap:8px;justify-content:center;margin:24px 0}.verification-input input{width:48px;height:56px;text-align:center;font-size:24px;font-weight:600;background:var(--bg-tertiary);border:1px solid var(--border);border-radius:10px;color:var(--text-primary)}.app-container{display:none;height:100vh}.app-container.active{display:flex}.server-sidebar{width:72px;background:var(--bg-tertiary);padding:12px 0;display:flex;flex-direction:column;align-items:center;gap:8px;overflow-y:auto}.server-icon{width:48px;height:48px;border-radius:50%;background:var(--bg-quaternary);display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all 0.2s;font-weight:600;font-size:18px;color:var(--text-primary);overflow:hidden}.server-icon img{width:100%;height:100%;object-fit:cover}.server-icon:hover,.server-icon.active{border-radius:16px;background:var(--accent)}.home-icon{background:var(--accent)!important;margin-bottom:8px}.home-icon svg{width:28px;height:28px}.server-divider{width:32px;height:2px;background:var(--border);margin:4px 0}.add-server{background:transparent!important;border:2px dashed var(--border);color:var(--success)}.add-server:hover{background:var(--success)!important;color:#fff;border-color:transparent}.add-server svg{width:24px;height:24px}.channel-sidebar{width:240px;background:var(--bg-secondary);display:flex;flex-direction:column}.server-header{padding:16px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;cursor:pointer}.server-header h2{font-size:15px;font-weight:600}.server-header svg{width:18px;height:18px;color:var(--text-secondary)}.channel-list{flex:1;overflow-y:auto;padding:12px 8px}.channel-category{margin-bottom:16px}.category-header{display:flex;align-items:center;padding:4px 8px;color:var(--text-muted);font-size:12px;font-weight:600;text-transform:uppercase}.category-header svg{width:12px;height:12px;margin-right:4px}.category-actions{margin-left:auto;cursor:pointer}.channel-item{display:flex;align-items:center;padding:8px 12px;margin:2px 0;border-radius:6px;cursor:pointer;color:var(--text-secondary);transition:all 0.15s}.channel-item:hover{background:rgba(255,255,255,0.05);color:var(--text-primary)}.channel-item.active{background:rgba(255,255,255,0.08);color:var(--text-primary)}.channel-item svg{width:20px;height:20px;margin-right:8px}.channel-name{font-size:14px;font-weight:500}.user-panel{padding:12px;background:var(--bg-tertiary);display:flex;align-items:center;gap:10px}.user-avatar{width:36px;height:36px;border-radius:50%;background:var(--accent);display:flex;align-items:center;justify-content:center;font-weight:600;font-size:14px;position:relative;overflow:hidden}.user-avatar img{width:100%;height:100%;object-fit:cover}.user-status{position:absolute;bottom:-2px;right:-2px;width:14px;height:14px;border-radius:50%;background:var(--online);border:3px solid var(--bg-tertiary)}.user-info{flex:1}.user-name{font-size:13px;font-weight:600}.user-tag{font-size:11px;color:var(--text-muted)}.user-action-btn{width:32px;height:32px;border-radius:6px;background:transparent;border:none;color:var(--text-secondary);cursor:pointer;display:flex;align-items:center;justify-content:center}.user-action-btn:hover{background:rgba(255,255,255,0.1);color:var(--text-primary)}.user-action-btn svg{width:18px;height:18px}.main-content{flex:1;display:flex;flex-direction:column;background:var(--bg-primary)}.chat-header{height:48px;padding:0 16px;display:flex;align-items:center;border-bottom:1px solid var(--border)}.chat-header svg{width:22px;height:22px;color:var(--text-muted);margin-right:10px}.chat-header h3{font-size:16px;font-weight:600}.chat-header-actions{margin-left:auto}.header-btn{width:32px;height:32px;border-radius:6px;background:transparent;border:none;color:var(--text-secondary);cursor:pointer;display:flex;align-items:center;justify-content:center}.header-btn:hover{color:var(--text-primary)}.messages-container{flex:1;overflow-y:auto;padding:16px;display:flex;flex-direction:column}.messages-list{display:flex;flex-direction:column;gap:4px;margin-top:auto}.message{display:flex;padding:4px 12px;border-radius:8px;position:relative}.message:hover{background:var(--message-hover)}.message-avatar{width:40px;height:40px;border-radius:50%;background:var(--accent);display:flex;align-items:center;justify-content:center;font-weight:600;font-size:16px;margin-right:12px;margin-top:4px;overflow:hidden}.message-avatar img{width:100%;height:100%;object-fit:cover}.message-content{flex:1}.message-header{display:flex;align-items:baseline;gap:8px;margin-bottom:4px}.message-author{font-weight:600;font-size:15px}.message-timestamp{font-size:11px;color:var(--text-muted)}.message-text{font-size:14px;line-height:1.5;color:var(--text-secondary)}.message-compact{padding-left:64px}.message-compact .message-avatar,.message-compact .message-header{display:none}.chat-input-container{padding:0 16px 24px}.chat-input-wrapper{background:var(--bg-quaternary);border-radius:12px;display:flex;align-items:flex-end;padding:4px}.chat-input-actions{display:flex;padding:8px}.input-action-btn{width:32px;height:32px;border-radius:6px;background:transparent;border:none;color:var(--text-secondary);cursor:pointer;display:flex;align-items:center;justify-content:center}.input-action-btn svg{width:22px;height:22px}.chat-input{flex:1;background:transparent;border:none;color:var(--text-primary);font-size:15px;padding:12px 0;resize:none;max-height:200px;font-family:inherit}.chat-input:focus{outline:none}.chat-input::placeholder{color:var(--text-muted)}.send-btn{width:36px;height:36px;border-radius:8px;background:var(--accent);border:none;color:#fff;cursor:pointer;display:flex;align-items:center;justify-content:center;margin:6px}.send-btn:hover{background:var(--accent-hover)}.send-btn:disabled{background:var(--bg-tertiary);color:var(--text-muted);cursor:not-allowed}.send-btn svg{width:20px;height:20px}.member-sidebar{width:240px;background:var(--bg-secondary);padding:16px;overflow-y:auto}.member-category{margin-bottom:20px}.member-category-title{font-size:12px;font-weight:600;color:var(--text-muted);text-transform:uppercase;margin-bottom:8px}.member-item{display:flex;align-items:center;padding:8px;border-radius:6px;cursor:pointer}.member-item:hover{background:rgba(255,255,255,0.05)}.member-avatar{width:32px;height:32px;border-radius:50%;background:var(--accent);display:flex;align-items:center;justify-content:center;font-weight:600;font-size:12px;margin-right:10px;position:relative;overflow:hidden}.member-avatar img{width:100%;height:100%;object-fit:cover}.member-status-dot{position:absolute;bottom:-1px;right:-1px;width:12px;height:12px;border-radius:50%;border:2px solid var(--bg-secondary)}.member-status-dot.online{background:var(--online)}.member-status-dot.offline{background:var(--offline)}.member-name{font-size:14px;color:var(--text-secondary)}.modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.7);display:flex;align-items:center;justify-content:center;z-index:1000;opacity:0;visibility:hidden;transition:all 0.2s}.modal-overlay.active{opacity:1;visibility:visible}.modal{background:var(--bg-quaternary);border-radius:16px;padding:24px;width:100%;max-width:440px}.modal-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:20px}.modal-header h2{font-size:20px}.modal-close{width:32px;height:32px;border-radius:50%;background:transparent;border:none;color:var(--text-secondary);cursor:pointer;display:flex;align-items:center;justify-content:center}.modal-close svg{width:20px;height:20px}.modal-actions{display:flex;gap:12px;margin-top:24px}.modal-actions .btn{flex:1}.home-view{display:none;flex-direction:column;height:100%}.home-view.active{display:flex}.dm-list{padding:8px}.dm-header{padding:8px 12px}.dm-header h3{font-size:12px;font-weight:600;color:var(--text-muted);text-transform:uppercase}.welcome-screen{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:40px}.welcome-screen svg{width:120px;height:120px;color:var(--accent);margin-bottom:24px}.welcome-screen h2{font-size:28px;margin-bottom:12px}.welcome-screen p{color:var(--text-secondary);max-width:400px}.loading-overlay{position:fixed;inset:0;background:var(--bg-primary);display:flex;align-items:center;justify-content:center;z-index:2000}.loading-spinner{width:48px;height:48px;border:3px solid var(--border);border-top-color:var(--accent);border-radius:50%;animation:spin 1s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}.toast-container{position:fixed;bottom:24px;right:24px;display:flex;flex-direction:column;gap:8px;z-index:3000}.toast{padding:14px 20px;background:var(--bg-quaternary);border-radius:10px;border:1px solid var(--border);display:flex;align-items:center;gap:12px;animation:slideIn 0.3s}@keyframes slideIn{from{transform:translateX(100%);opacity:0}to{transform:translateX(0);opacity:1}}.toast.success{border-color:var(--success)}.toast.error{border-color:var(--danger)}.toast svg{width:20px;height:20px}.toast.success svg{color:var(--success)}.toast.error svg{color:var(--danger)}.settings-view{position:fixed;inset:0;background:var(--bg-primary);display:none;z-index:1500}.settings-view.active{display:flex}.settings-sidebar{width:240px;background:var(--bg-secondary);padding:60px 20px 20px}.settings-category{margin-bottom:24px}.settings-category-title{font-size:11px;font-weight:700;color:var(--text-muted);text-transform:uppercase;padding:8px 12px}.settings-item{padding:10px 12px;border-radius:6px;font-size:14px;color:var(--text-secondary);cursor:pointer}.settings-item:hover,.settings-item.active{background:rgba(255,255,255,0.05);color:var(--text-primary)}.settings-item.danger{color:var(--danger)}.settings-content{flex:1;padding:60px 40px}.settings-close{position:fixed;top:60px;right:40px;width:40px;height:40px;border-radius:50%;background:transparent;border:2px solid var(--border);color:var(--text-secondary);cursor:pointer;display:flex;align-items:center;justify-content:center}.settings-section{max-width:600px}.settings-section h2{font-size:20px;margin-bottom:20px}.settings-card{background:var(--bg-secondary);border-radius:12px;padding:20px;margin-bottom:20px}.settings-row{display:flex;align-items:center;padding:16px 0;border-bottom:1px solid var(--border)}.settings-row:last-child{border-bottom:none}.settings-row-info{flex:1}.settings-row-label{font-size:14px;font-weight:500;margin-bottom:4px}.settings-row-value{font-size:13px;color:var(--text-muted)}.context-menu{position:fixed;background:var(--bg-quaternary);border-radius:8px;border:1px solid var(--border);padding:6px;min-width:180px;z-index:2000;display:none}.context-menu.active{display:block}.context-item{padding:10px 12px;border-radius:4px;font-size:14px;color:var(--text-secondary);cursor:pointer;display:flex;align-items:center;gap:10px}.context-item:hover{background:var(--accent);color:#fff}.context-item.danger:hover{background:var(--danger)}.context-item svg{width:18px;height:18px}.context-divider{height:1px;background:var(--border);margin:6px 0}.invite-code{display:flex;gap:8px;margin-top:16px}.invite-code input{flex:1;padding:14px;background:var(--bg-tertiary);border:1px solid var(--border);border-radius:10px;color:var(--text-primary);font-family:monospace}.invite-code .btn{width:auto;padding:14px 20px}.hidden{display:none!important}@media(max-width:1200px){.member-sidebar{display:none}}@media(max-width:768px){.channel-sidebar{display:none}}
    </style>
</head>
<body>
    <div class="loading-overlay" id="loadingOverlay"><div class="loading-spinner"></div></div>
    <div class="auth-container" id="authContainer">
        <div class="auth-box">
            <div class="auth-logo"><h1>Chat.</h1><p>Connect with friends and communities</p></div>
            <div class="auth-tabs"><button class="auth-tab active" data-tab="email">Email</button><button class="auth-tab" data-tab="phone">Phone</button></div>
            <form class="auth-form active" id="emailForm" data-form="email">
                <div class="form-group"><label>Email</label><input type="email" id="emailInput" placeholder="Enter your email" required></div>
                <div class="form-group"><label>Password</label><input type="password" id="passwordInput" placeholder="Enter your password" required></div>
                <div class="form-group" id="usernameGroup" style="display:none"><label>Username</label><input type="text" id="usernameInput" placeholder="Choose a username"></div>
                <button type="submit" class="btn btn-primary" id="emailSubmitBtn">Sign In</button>
                <p style="text-align:center;margin-top:12px"><a href="#" id="toggleAuthMode" style="color:var(--accent);text-decoration:none;font-size:14px">Need an account? Register</a></p>
                <div class="divider"><span>or continue with</span></div>
                <button type="button" class="btn btn-google" id="googleSignIn"><svg viewBox="0 0 24 24" style="width:20px;height:20px"><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/><path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/><path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/><path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/></svg>Continue with Google</button>
            </form>
            <form class="auth-form" id="phoneForm" data-form="phone">
                <div id="phoneStep1">
                    <div class="form-group"><label>Phone Number</label><div class="phone-input-group"><select id="countryCode"><option value="+1">+1</option><option value="+44">+44</option><option value="+91">+91</option></select><input type="tel" id="phoneInput" placeholder="Phone number" required></div></div>
                    <button type="button" class="btn btn-primary" id="sendCodeBtn">Send Code</button>
                    <div id="recaptcha-container"></div>
                </div>
                <div id="phoneStep2" style="display:none">
                    <div class="verification-sent"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg><h3>Verification Code Sent</h3><p style="color:var(--text-secondary);font-size:14px">Enter the 6-digit code</p></div>
                    <div class="verification-input"><input type="text" maxlength="1" class="code-input"><input type="text" maxlength="1" class="code-input"><input type="text" maxlength="1" class="code-input"><input type="text" maxlength="1" class="code-input"><input type="text" maxlength="1" class="code-input"><input type="text" maxlength="1" class="code-input"></div>
                    <button type="button" class="btn btn-primary" id="verifyCodeBtn">Verify</button>
                </div>
            </form>
        </div>
    </div>
    <div class="app-container" id="appContainer">
        <div class="server-sidebar">
            <div class="server-icon home-icon active" data-server="home" title="Home"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/></svg></div>
            <div class="server-divider"></div>
            <div id="serverList"></div>
            <div class="server-icon add-server" id="addServerBtn" title="Add Server"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg></div>
        </div>
        <div class="channel-sidebar" id="channelSidebar">
            <div class="home-view active" id="homeView"><div class="server-header"><h2>Direct Messages</h2></div><div class="dm-list"><div class="dm-header"><h3>Friends</h3></div><div id="dmList"></div></div></div>
            <div class="server-view hidden" id="serverView"><div class="server-header" id="serverHeader"><h2 id="serverName">Server</h2><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg></div><div class="channel-list" id="channelList"></div></div>
            <div class="user-panel"><div class="user-avatar" id="userAvatar"><div class="user-status"></div></div><div class="user-info"><div class="user-name" id="userName">User</div><div class="user-tag" id="userTag">#0000</div></div><div class="user-actions"><button class="user-action-btn" id="settingsBtn"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg></button></div></div>
        </div>
        <div class="main-content">
            <div class="chat-header"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M5.88 21.26l.1-.72.16-1.2.06-.43-.39-.16a5.92 5.92 0 0 1-3.8-5.5c0-3.3 3.04-6 6.74-6s6.75 2.7 6.75 6c0 3.3-3.05 6-6.75 6a7.3 7.3 0 0 1-1.6-.18l-.45-.1-.43.18c-.75.32-1.53.56-2.39.85l.05-.26z"/></svg><h3 id="chatTitle">Welcome</h3><div class="chat-header-actions"><button class="header-btn" id="toggleMembersBtn"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg></button></div></div>
            <div class="welcome-screen" id="welcomeScreen"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg><h2>Welcome to Chat.</h2><p>Select a server to start chatting.</p></div>
            <div class="messages-container hidden" id="messagesContainer"><div class="messages-list" id="messagesList"></div></div>
            <div class="chat-input-container hidden" id="chatInputContainer"><div class="chat-input-wrapper"><div class="chat-input-actions"><button class="input-action-btn"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="16"/><line x1="8" y1="12" x2="16" y2="12"/></svg></button></div><textarea class="chat-input" id="messageInput" placeholder="Message #general" rows="1"></textarea><button class="send-btn" id="sendBtn" disabled><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg></button></div></div>
        </div>
        <div class="member-sidebar" id="memberSidebar"><div class="member-category"><div class="member-category-title">Online — <span id="onlineCount">0</span></div><div id="onlineMembers"></div></div><div class="member-category"><div class="member-category-title">Offline — <span id="offlineCount">0</span></div><div id="offlineMembers"></div></div></div>
    </div>
    <div class="settings-view" id="settingsView"><div class="settings-sidebar"><div class="settings-category"><div class="settings-category-title">User Settings</div><div class="settings-item active">My Account</div></div><div class="settings-category"><div class="settings-item danger" id="logoutBtn">Log Out</div></div></div><div class="settings-content"><div class="settings-section"><h2>My Account</h2><div class="settings-card"><div class="settings-row"><div class="user-avatar" id="settingsAvatar" style="width:80px;height:80px;font-size:32px"></div><div class="settings-row-info" style="margin-left:20px"><div class="settings-row-label" id="settingsUsername">User</div><div class="settings-row-value" id="settingsEmail">email</div></div></div></div></div></div><button class="settings-close" id="settingsClose"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button></div>
    <div class="modal-overlay" id="createServerModal"><div class="modal"><div class="modal-header"><h2>Create a Server</h2><button class="modal-close" onclick="closeModal('createServerModal')"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button></div><div class="form-group"><label>Server Name</label><input type="text" id="newServerName" placeholder="My Server"></div><div class="modal-actions"><button class="btn btn-secondary" onclick="closeModal('createServerModal')">Cancel</button><button class="btn btn-primary" id="createServerBtn">Create</button></div></div></div>
    <div class="modal-overlay" id="createChannelModal"><div class="modal"><div class="modal-header"><h2>Create Channel</h2><button class="modal-close" onclick="closeModal('createChannelModal')"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button></div><div class="form-group"><label>Channel Name</label><input type="text" id="newChannelName" placeholder="general"></div><div class="modal-actions"><button class="btn btn-secondary" onclick="closeModal('createChannelModal')">Cancel</button><button class="btn btn-primary" id="createChannelBtn">Create</button></div></div></div>
    <div class="modal-overlay" id="inviteModal"><div class="modal"><div class="modal-header"><h2>Invite Friends</h2><button class="modal-close" onclick="closeModal('inviteModal')"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button></div><p style="color:var(--text-secondary)">Share this invite code:</p><div class="invite-code"><input type="text" id="inviteCodeInput" readonly><button class="btn btn-primary" id="copyInviteBtn">Copy</button></div></div></div>
    <div class="modal-overlay" id="joinServerModal"><div class="modal"><div class="modal-header"><h2>Join a Server</h2><button class="modal-close" onclick="closeModal('joinServerModal')"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button></div><div class="form-group"><label>Invite Code</label><input type="text" id="joinServerCode" placeholder="Enter code"></div><div class="modal-actions"><button class="btn btn-secondary" onclick="closeModal('joinServerModal')">Cancel</button><button class="btn btn-primary" id="joinServerBtn">Join</button></div></div></div>
    <div class="modal-overlay" id="serverOptionsModal"><div class="modal"><div class="modal-header"><h2>Add a Server</h2><button class="modal-close" onclick="closeModal('serverOptionsModal')"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button></div><button class="btn btn-primary" onclick="closeModal('serverOptionsModal');openModal('createServerModal')" style="margin-bottom:12px">Create My Own</button><button class="btn btn-secondary" onclick="closeModal('serverOptionsModal');openModal('joinServerModal')">Join a Server</button></div></div>
    <div class="context-menu" id="contextMenu"><div class="context-item" id="contextInvite"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="8.5" cy="7" r="4"/><line x1="20" y1="8" x2="20" y2="14"/><line x1="23" y1="11" x2="17" y2="11"/></svg>Invite People</div><div class="context-item" id="contextCreateChannel"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>Create Channel</div><div class="context-divider"></div><div class="context-item danger" id="contextLeaveServer"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>Leave Server</div></div>
    <div class="toast-container" id="toastContainer"></div>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>    <script>
        var firebaseConfig={apiKey:"AIzaSyBJMIUucxOusoVzs4lc-QurCxjlW6Hlsuw",authDomain:"chat-5f0bf.firebaseapp.com",projectId:"chat-5f0bf",storageBucket:"chat-5f0bf.firebasestorage.app",messagingSenderId:"211425841353",appId:"1:211425841353:web:e1c271a340d73abd0cfd18"};
        firebase.initializeApp(firebaseConfig);
        var auth=firebase.auth(),db=firebase.firestore();
        var currentUser=null,currentServer=null,currentChannel=null,isRegistering=false,confirmationResult=null,unsubMessages=null,unsubServers=null,unsubMembers=null;

        document.addEventListener('DOMContentLoaded',function(){
            auth.onAuthStateChanged(function(user){
                if(user){currentUser=user;ensureUserProfile(user).then(function(){showApp();loadServers();updateUserPanel();})}
                else{currentUser=null;showAuth()}
            });
            initEventListeners();
        });

        function ensureUserProfile(user){
            var ref=db.collection('users').doc(user.uid);
            return ref.get().then(function(doc){
                if(!doc.exists){return ref.set({uid:user.uid,email:user.email||'',displayName:user.displayName||user.email.split('@')[0]||'User',photoURL:user.photoURL||'',tag:Math.floor(1000+Math.random()*9000),status:'online',createdAt:firebase.firestore.FieldValue.serverTimestamp()})}
                return ref.update({status:'online'})
            });
        }

        function initEventListeners(){
            document.querySelectorAll('.auth-tab').forEach(function(t){t.addEventListener('click',function(){document.querySelectorAll('.auth-tab').forEach(function(x){x.classList.remove('active')});document.querySelectorAll('.auth-form').forEach(function(x){x.classList.remove('active')});t.classList.add('active');document.querySelector('.auth-form[data-form="'+t.dataset.tab+'"]').classList.add('active')})});
            document.getElementById('toggleAuthMode').addEventListener('click',function(e){e.preventDefault();isRegistering=!isRegistering;document.getElementById('usernameGroup').style.display=isRegistering?'block':'none';document.getElementById('emailSubmitBtn').textContent=isRegistering?'Create Account':'Sign In';e.target.textContent=isRegistering?'Already have an account? Sign In':'Need an account? Register'});
            document.getElementById('emailForm').addEventListener('submit',function(e){e.preventDefault();var email=document.getElementById('emailInput').value,pass=document.getElementById('passwordInput').value;if(isRegistering){auth.createUserWithEmailAndPassword(email,pass).then(function(r){var u=document.getElementById('usernameInput').value;if(u)return r.user.updateProfile({displayName:u})}).then(function(){showToast('Account created!','success')}).catch(function(err){showToast(err.message,'error')})}else{auth.signInWithEmailAndPassword(email,pass).then(function(){showToast('Welcome back!','success')}).catch(function(err){showToast(err.message,'error')})}});
            document.getElementById('googleSignIn').addEventListener('click',function(){auth.signInWithPopup(new firebase.auth.GoogleAuthProvider()).then(function(){showToast('Signed in!','success')}).catch(function(err){showToast(err.message,'error')})});
            document.getElementById('sendCodeBtn').addEventListener('click',function(){var phone=document.getElementById('countryCode').value+document.getElementById('phoneInput').value;window.recaptchaVerifier=new firebase.auth.RecaptchaVerifier('recaptcha-container',{size:'invisible'});auth.signInWithPhoneNumber(phone,window.recaptchaVerifier).then(function(r){confirmationResult=r;document.getElementById('phoneStep1').style.display='none';document.getElementById('phoneStep2').style.display='block';showToast('Code sent!','success')}).catch(function(err){showToast(err.message,'error')})});
            document.querySelectorAll('.code-input').forEach(function(inp,i,arr){inp.addEventListener('input',function(e){if(e.target.value&&i<arr.length-1)arr[i+1].focus()});inp.addEventListener('keydown',function(e){if(e.key==='Backspace'&&!e.target.value&&i>0)arr[i-1].focus()})});
            document.getElementById('verifyCodeBtn').addEventListener('click',function(){var code=Array.from(document.querySelectorAll('.code-input')).map(function(x){return x.value}).join('');confirmationResult.confirm(code).then(function(){showToast('Verified!','success')}).catch(function(){showToast('Invalid code','error')})});
            document.getElementById('addServerBtn').addEventListener('click',function(){openModal('serverOptionsModal')});
            document.getElementById('createServerBtn').addEventListener('click',createServer);
            document.getElementById('joinServerBtn').addEventListener('click',joinServer);
            document.getElementById('createChannelBtn').addEventListener('click',createChannel);
            var msgInput=document.getElementById('messageInput'),sendBtn=document.getElementById('sendBtn');
            msgInput.addEventListener('input',function(){sendBtn.disabled=!msgInput.value.trim();msgInput.style.height='auto';msgInput.style.height=msgInput.scrollHeight+'px'});
            msgInput.addEventListener('keydown',function(e){if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();sendMessage()}});
            sendBtn.addEventListener('click',sendMessage);
            document.querySelector('.home-icon').addEventListener('click',showHome);
            document.getElementById('settingsBtn').addEventListener('click',function(){document.getElementById('settingsView').classList.add('active');updateSettingsUI()});
            document.getElementById('settingsClose').addEventListener('click',function(){document.getElementById('settingsView').classList.remove('active')});
            document.getElementById('logoutBtn').addEventListener('click',function(){if(currentUser)db.collection('users').doc(currentUser.uid).update({status:'offline'});auth.signOut();document.getElementById('settingsView').classList.remove('active')});
            document.getElementById('serverHeader').addEventListener('click',function(e){if(!currentServer)return;var m=document.getElementById('contextMenu');m.style.top=e.clientY+'px';m.style.left=e.clientX+'px';m.classList.add('active')});
            document.getElementById('contextInvite').addEventListener('click',function(){closeContextMenu();document.getElementById('inviteCodeInput').value=currentServer.inviteCode||'';openModal('inviteModal')});
            document.getElementById('contextCreateChannel').addEventListener('click',function(){closeContextMenu();openModal('createChannelModal')});
            document.getElementById('contextLeaveServer').addEventListener('click',function(){closeContextMenu();leaveServer()});
            document.getElementById('copyInviteBtn').addEventListener('click',function(){var inp=document.getElementById('inviteCodeInput');inp.select();document.execCommand('copy');showToast('Copied!','success')});
            document.getElementById('toggleMembersBtn').addEventListener('click',function(){document.getElementById('memberSidebar').classList.toggle('hidden')});
            document.addEventListener('click',function(e){if(!e.target.closest('.context-menu')&&!e.target.closest('.server-header'))closeContextMenu()});
        }

        function showAuth(){document.getElementById('loadingOverlay').style.display='none';document.getElementById('authContainer').style.display='flex';document.getElementById('appContainer').classList.remove('active')}
        function showApp(){document.getElementById('loadingOverlay').style.display='none';document.getElementById('authContainer').style.display='none';document.getElementById('appContainer').classList.add('active')}
        function showHome(){document.querySelectorAll('.server-icon').forEach(function(s){s.classList.remove('active')});document.querySelector('.home-icon').classList.add('active');document.getElementById('homeView').classList.add('active');document.getElementById('serverView').classList.add('hidden');document.getElementById('welcomeScreen').classList.remove('hidden');document.getElementById('messagesContainer').classList.add('hidden');document.getElementById('chatInputContainer').classList.add('hidden');document.getElementById('chatTitle').textContent='Welcome';currentServer=null;currentChannel=null;if(unsubMessages)unsubMessages()}

        function updateUserPanel(){db.collection('users').doc(currentUser.uid).get().then(function(doc){var d=doc.data()||{};document.getElementById('userName').textContent=d.displayName||'User';document.getElementById('userTag').textContent='#'+(d.tag||'0000');var av=document.getElementById('userAvatar');if(currentUser.photoURL)av.innerHTML='<img src="'+currentUser.photoURL+'"><div class="user-status"></div>';else av.innerHTML=(d.displayName||'U')[0].toUpperCase()+'<div class="user-status"></div>'})}
        function updateSettingsUI(){db.collection('users').doc(currentUser.uid).get().then(function(doc){var d=doc.data()||{};document.getElementById('settingsUsername').textContent=d.displayName||'User';document.getElementById('settingsEmail').textContent=currentUser.email||'';var av=document.getElementById('settingsAvatar');if(currentUser.photoURL)av.innerHTML='<img src="'+currentUser.photoURL+'" style="width:100%;height:100%;border-radius:50%">';else av.textContent=(d.displayName||'U')[0].toUpperCase()})}

        function loadServers(){if(unsubServers)unsubServers();unsubServers=db.collection('servers').where('members','array-contains',currentUser.uid).onSnapshot(function(snap){var list=document.getElementById('serverList');list.innerHTML='';snap.forEach(function(doc){var s=Object.assign({id:doc.id},doc.data());var el=document.createElement('div');el.className='server-icon';el.dataset.server=s.id;el.title=s.name;el.textContent=s.name.split(' ').map(function(w){return w[0]}).join('').substring(0,2).toUpperCase();el.addEventListener('click',function(){selectServer(s)});list.appendChild(el)})})}
        function selectServer(server){currentServer=server;currentChannel=null;document.querySelectorAll('.server-icon').forEach(function(s){s.classList.remove('active')});var el=document.querySelector('[data-server="'+server.id+'"]');if(el)el.classList.add('active');document.getElementById('homeView').classList.remove('active');document.getElementById('serverView').classList.remove('hidden');document.getElementById('serverName').textContent=server.name;loadChannels(server.id);loadMembers(server.id)}
        function loadChannels(serverId){db.collection('servers').doc(serverId).collection('channels').orderBy('createdAt').onSnapshot(function(snap){var list=document.getElementById('channelList');list.innerHTML='<div class="channel-category"><div class="category-header"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:12px;height:12px;margin-right:4px"><polyline points="6 9 12 15 18 9"/></svg>TEXT CHANNELS<div class="category-actions" onclick="openModal(\'createChannelModal\')"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:16px;height:16px"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg></div></div><div id="textChannels"></div></div>';var tc=document.getElementById('textChannels');if(snap.empty){db.collection('servers').doc(serverId).collection('channels').add({name:'general',type:'text',createdAt:firebase.firestore.FieldValue.serverTimestamp()});return}var first=null;snap.forEach(function(doc){var c=Object.assign({id:doc.id},doc.data());if(!first)first=c;var el=document.createElement('div');el.className='channel-item';el.dataset.channel=c.id;el.innerHTML='<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 9h16M4 15h16M10 3L8 21M16 3l-2 18"/></svg><span class="channel-name">'+c.name+'</span>';el.addEventListener('click',function(){selectChannel(c)});tc.appendChild(el)});if(first&&!currentChannel)selectChannel(first)})}
        function selectChannel(channel){currentChannel=channel;document.querySelectorAll('.channel-item').forEach(function(c){c.classList.remove('active')});var el=document.querySelector('[data-channel="'+channel.id+'"]');if(el)el.classList.add('active');document.getElementById('welcomeScreen').classList.add('hidden');document.getElementById('messagesContainer').classList.remove('hidden');document.getElementById('chatInputContainer').classList.remove('hidden');document.getElementById('chatTitle').textContent=channel.name;document.getElementById('messageInput').placeholder='Message #'+channel.name;loadMessages()}
        function loadMessages(){if(unsubMessages)unsubMessages();var list=document.getElementById('messagesList');list.innerHTML='';unsubMessages=db.collection('servers').doc(currentServer.id).collection('channels').doc(currentChannel.id).collection('messages').orderBy('timestamp','asc').limitToLast(50).onSnapshot(function(snap){list.innerHTML='';var lastAuth=null,lastTime=null;snap.forEach(function(doc){var m=Object.assign({id:doc.id},doc.data());var compact=m.authorId===lastAuth&&lastTime&&m.timestamp&&m.timestamp.toMillis()-lastTime<300000;var el=document.createElement('div');el.className='message'+(compact?' message-compact':'');var time=m.timestamp?m.timestamp.toDate():new Date();var timeStr=time.toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'});var dateStr=time.toLocaleDateString();if(!compact)el.innerHTML='<div class="message-avatar" style="background:hsl('+hashCode(m.authorId)%360+',70%,50%)">'+(m.authorAvatar?'<img src="'+m.authorAvatar+'">':(m.authorName||'U')[0].toUpperCase())+'</div><div class="message-content"><div class="message-header"><span class="message-author">'+(m.authorName||'Unknown')+'</span><span class="message-timestamp">'+dateStr+' '+timeStr+'</span></div><div class="message-text">'+escapeHtml(m.content)+'</div></div>';else el.innerHTML='<div class="message-content"><div class="message-text">'+escapeHtml(m.content)+'</div></div>';list.appendChild(el);lastAuth=m.authorId;lastTime=m.timestamp?m.timestamp.toMillis():null});document.getElementById('messagesContainer').scrollTop=document.getElementById('messagesContainer').scrollHeight})}
        function sendMessage(){var inp=document.getElementById('messageInput'),content=inp.value.trim();if(!content||!currentServer||!currentChannel)return;db.collection('users').doc(currentUser.uid).get().then(function(doc){var d=doc.data()||{};return db.collection('servers').doc(currentServer.id).collection('channels').doc(currentChannel.id).collection('messages').add({content:content,authorId:currentUser.uid,authorName:d.displayName||'Unknown',authorAvatar:currentUser.photoURL||'',timestamp:firebase.firestore.FieldValue.serverTimestamp()})}).then(function(){inp.value='';inp.style.height='auto';document.getElementById('sendBtn').disabled=true}).catch(function(){showToast('Failed to send','error')})}
        function createServer(){var name=document.getElementById('newServerName').value.trim();if(!name){showToast('Enter a name','error');return}var code=generateCode();db.collection('servers').add({name:name,ownerId:currentUser.uid,members:[currentUser.uid],inviteCode:code,createdAt:firebase.firestore.FieldValue.serverTimestamp()}).then(function(ref){return ref.collection('channels').add({name:'general',type:'text',createdAt:firebase.firestore.FieldValue.serverTimestamp()})}).then(function(){closeModal('createServerModal');document.getElementById('newServerName').value='';showToast('Server created!','success')}).catch(function(){showToast('Failed','error')})}
        function joinServer(){var code=document.getElementById('joinServerCode').value.trim();if(!code){showToast('Enter a code','error');return}db.collection('servers').where('inviteCode','==',code).limit(1).get().then(function(snap){if(snap.empty){showToast('Invalid code','error');return}var doc=snap.docs[0];if(doc.data().members.includes(currentUser.uid)){showToast('Already joined','error');return}return doc.ref.update({members:firebase.firestore.FieldValue.arrayUnion(currentUser.uid)})}).then(function(){closeModal('joinServerModal');document.getElementById('joinServerCode').value='';showToast('Joined!','success')}).catch(function(){showToast('Failed','error')})}
        function createChannel(){var name=document.getElementById('newChannelName').value.trim().toLowerCase().replace(/\s+/g,'-');if(!name||!currentServer){showToast('Enter a name','error');return}db.collection('servers').doc(currentServer.id).collection('channels').add({name:name,type:'text',createdAt:firebase.firestore.FieldValue.serverTimestamp()}).then(function(){closeModal('createChannelModal');document.getElementById('newChannelName').value='';showToast('Channel created!','success')}).catch(function(){showToast('Failed','error')})}
        function leaveServer(){if(!currentServer)return;if(currentServer.ownerId===currentUser.uid){showToast("Can't leave own server",'error');return}db.collection('servers').doc(currentServer.id).update({members:firebase.firestore.FieldValue.arrayRemove(currentUser.uid)}).then(function(){showHome();showToast('Left server','success')}).catch(function(){showToast('Failed','error')})}
        function loadMembers(serverId){if(unsubMembers)unsubMembers();unsubMembers=db.collection('servers').doc(serverId).onSnapshot(function(doc){var members=doc.data().members||[];var onC=document.getElementById('onlineMembers'),offC=document.getElementById('offlineMembers');onC.innerHTML='';offC.innerHTML='';var onN=0,offN=0;members.forEach(function(uid){db.collection('users').doc(uid).get().then(function(udoc){var u=udoc.data()||{};var online=u.status==='online';var el=document.createElement('div');el.className='member-item';el.innerHTML='<div class="member-avatar" style="background:hsl('+hashCode(uid)%360+',70%,50%)">'+(u.photoURL?'<img src="'+u.photoURL+'">':(u.displayName||'U')[0].toUpperCase())+'<div class="member-status-dot '+(online?'online':'offline')+'"></div></div><span class="member-name">'+(u.displayName||'Unknown')+'</span>';if(online){onC.appendChild(el);onN++}else{offC.appendChild(el);offN++}document.getElementById('onlineCount').textContent=onN;document.getElementById('offlineCount').textContent=offN})})})}
        function openModal(id){document.getElementById(id).classList.add('active')}
        function closeModal(id){document.getElementById(id).classList.remove('active')}
        function closeContextMenu(){document.getElementById('contextMenu').classList.remove('active')}
        function showToast(msg,type){var c=document.getElementById('toastContainer'),t=document.createElement('div');t.className='toast '+type;t.innerHTML='<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">'+(type==='success'?'<path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/>':'<circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/>')+'</svg><span>'+msg+'</span>';c.appendChild(t);setTimeout(function(){t.remove()},4000)}
        function generateCode(){var c='ABCDEFGHJKLMNPQRSTUVWXYZabcdefghjkmnpqrstuvwxyz23456789',r='';for(var i=0;i<8;i++)r+=c.charAt(Math.floor(Math.random()*c.length));return r}
        function hashCode(s){var h=0;for(var i=0;i<s.length;i++)h=s.charCodeAt(i)+((h<<5)-h);return Math.abs(h)}
        function escapeHtml(t){var d=document.createElement('div');d.textContent=t;return d.innerHTML}
        window.addEventListener('beforeunload',function(){if(currentUser)db.collection('users').doc(currentUser.uid).update({status:'offline'})});
    </script>
</body>
</html>
